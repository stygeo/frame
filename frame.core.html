<!DOCTYPE html>

<html>
<head>
  <title>frame.core.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>frame.core.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>$(<span class="keyword">function</span>() {
  <span class="keyword">var</span> Frame = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Helper methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> __emptyHash = {}, __has, __extend, __currentGID = <span class="number">0</span>,
  __has = <span class="keyword">function</span>(object, property) { <span class="keyword">return</span> __emptyHash.hasOwnProperty.call(object, property); },
  __keys = <span class="keyword">function</span>(object) {
    <span class="keyword">var</span> keys = []
    <span class="keyword">for</span>(<span class="keyword">var</span> k <span class="keyword">in</span> object) {
      <span class="keyword">if</span>(object.hasOwnProperty(k)) {
        keys.push(k);
      }
    }
    <span class="keyword">return</span> keys;
  },
  __merge = <span class="keyword">function</span>(hash, otherHash) {
    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> otherHash) {
      <span class="keyword">if</span> (__has(otherHash, key) &amp;&amp; !__has(hash, key)) {
        hash[key] = otherHash[key];
      }
    }
  },
  __makeArray = <span class="keyword">function</span>(object) {
    <span class="keyword">if</span>( !(object <span class="keyword">instanceof</span> Array) ) {
      object = [object];
    }
    <span class="keyword">return</span> object;
  },
  __isBasicObject = <span class="keyword">function</span>(object) {
    <span class="keyword">return</span> __has(object, <span class="string">'basicObjectDefined'</span>);
  },
  __isString = <span class="keyword">function</span>(object) {
    <span class="keyword">return</span> <span class="keyword">typeof</span>(object) == <span class="string">"string"</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Returns a new GID with the given prefix. GIDs are always returned as string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  __gid = <span class="keyword">function</span>(prefix) {
    <span class="keyword">var</span> GID = (++__currentGID).toString();
    <span class="keyword">if</span>(prefix) {
      GID = prefex+<span class="string">"-"</span>+GID;
    }

    <span class="keyword">return</span> GID;
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Creates a shared instance method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="function"><span class="keyword">function</span> <span class="title">createDefaultInstanceMethodOn</span><span class="params">(object)</span> {</span>
    Object.defineProperty(object, <span class="string">'default'</span>, {
      get: <span class="keyword">function</span>() {
        <span class="keyword">if</span>(!<span class="keyword">this</span>.__sharedInstance) { <span class="keyword">this</span>.__sharedInstance = <span class="keyword">new</span> object(); }
        <span class="keyword">return</span> <span class="keyword">this</span>.__sharedInstance;
      },
      set: <span class="keyword">function</span>(){}
    });
  }

  __extend = <span class="keyword">function</span>(propertiesOrProtoProps, protoProps) {
    <span class="keyword">var</span> parent = <span class="keyword">this</span>;
    <span class="keyword">var</span> child, properties;
    <span class="keyword">if</span>(propertiesOrProtoProps <span class="keyword">instanceof</span> Array) {
      properties = properties;
    } <span class="keyword">else</span> {
      protoProps = propertiesOrProtoProps;
    }

    <span class="keyword">if</span> (protoProps &amp;&amp; __has(protoProps, <span class="string">'constructor'</span>)) {
      child = protoProps.constructor;
    } <span class="keyword">else</span> {
      child = <span class="keyword">function</span>(){ <span class="keyword">return</span> parent.apply(<span class="keyword">this</span>, arguments); };
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Set the prototype chain to inherit from <code>parent</code>, without calling
<code>parent</code>&#39;s constructor function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> Surrogate = <span class="keyword">function</span>(){ <span class="keyword">this</span>.constructor = child; };
    Surrogate.prototype = parent.prototype;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Copy over static methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    child.prototype = <span class="keyword">new</span> Surrogate;
    <span class="keyword">if</span> (protoProps) _.extend(child.prototype, protoProps);</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Copy over static methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> parent) {
      <span class="keyword">if</span> (__has(parent, key)) {
        child[key] = parent[key];
      }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Set a convenience property in case the parent&#39;s prototype is needed
later.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    child.__super__ = parent.prototype;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Set the properties on the object if any was given</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span>(properties) {
      child.property(properties);
    }

    <span class="keyword">return</span> child;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Basic low level object. Contains most low level object functions such as KVO &amp; KVC.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> BasicObject = <span class="keyword">function</span>(options) {
    <span class="comment">/* These values are not meant to be KVO. */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Determines whether this object is a basic object so you can distinguish them from regular objects.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>.basicObjectDefined=<span class="literal">true</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>The current id of the object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>.gid = __gid();
  };
  BasicObject.extend = __extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Public property setter. Creates specialized properties which can be accessed through KVC and make use of KVO</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.property = <span class="keyword">function</span>(propertyNames) {
    propertyNames = __makeArray(propertyNames);

    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; propertyNames.length; i++) {
      <span class="keyword">var</span> propertyName = propertyNames[i];

      <span class="keyword">if</span>( !(propertyNames <span class="keyword">in</span> <span class="keyword">this</span>.prototype) ) {
        Object.defineProperty(<span class="keyword">this</span>.prototype, propertyName, {
          enumerable: <span class="literal">true</span>,
          get: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.getProperty(propertyName)
          },
          set: <span class="keyword">function</span>(value) {
            <span class="keyword">this</span>.setProperty(propertyName, value)
          }
        });
      }
    }
  }

  BasicObject.prototype.properties = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>._properties || (<span class="keyword">this</span>._properties = {})
  }
  BasicObject.prototype.observers = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>._observers || (<span class="keyword">this</span>._observers = {})
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Specialized setter. Calls callbacks on observed values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.setProperty = <span class="keyword">function</span>(key, value) {
    <span class="keyword">this</span>.properties()[key] = value

    <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key] &amp;&amp; <span class="keyword">this</span>.observers[key].length &gt; <span class="number">0</span>) {
      <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.observers[key].length; i++) {
        <span class="keyword">var</span> observer = <span class="keyword">this</span>.observers[key][i]
        <span class="keyword">if</span>(observer !== <span class="literal">undefined</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Signal the observer or call the callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="keyword">if</span>($.isFunction(observer)) {
            observer.call(<span class="keyword">this</span>, key, value);
          } <span class="keyword">else</span> {
            observer.observeValueForKey.call(observer, key, value)
          }
        }
      }
    }
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Basic object getter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.getProperty = <span class="keyword">function</span>(key) {
    <span class="keyword">return</span> <span class="keyword">this</span>.properties()[key]
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Returns the given or sets the given key with value (Key Value Coding, KVC)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.valueForKey = <span class="keyword">function</span>(value_or_key, key) {
    <span class="keyword">if</span>(key === <span class="literal">undefined</span>) {
      <span class="keyword">return</span> <span class="keyword">this</span>.getProperty(value_or_key)
    }

    <span class="keyword">this</span>.setProperty(key, value_or_key)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Observe the given key. (Key Value Observing, KVO)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.addObserverForKey = <span class="keyword">function</span>(observerOrKey, keyOrCallback, options) {
    <span class="keyword">var</span> observer, key;
    <span class="keyword">if</span>(__isString(observerOrKey) &amp;&amp; $.isFunction(keyOrCallback)) {
      observer = keyOrCallback;
      key = observerOrKey;
    } <span class="keyword">else</span> {
      observer = observerOrKey;
      key = keyOrCallback;
    }

    <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key] === <span class="literal">undefined</span>) {
      <span class="keyword">this</span>.observers[key] = []
    }

    <span class="keyword">this</span>.observers[key].push(observer)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Remove the given observer with the specified key</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.removeObserverForKey = <span class="keyword">function</span>(observer, key) {
    <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key]) {
      <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.observers[key].length; i++) {
        <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key][i] === observer) {
          <span class="keyword">delete</span> <span class="keyword">this</span>.observers[key][i]
          <span class="keyword">break</span>
        }
      }
    }
  }

  <span class="comment">/*
   * Frame.Model data object.
   */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>The basic model. Inherit from this object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Model = BasicObject.extend({
    constructor: <span class="keyword">function</span>(attributes, options) {</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Call the basic object&#39;s constructor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      BasicObject.call(<span class="keyword">this</span>, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Define this as a new model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.isNew = <span class="literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Serialize the attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.serialize(attributes);

    },</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Load data from the remote source</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    fetch: <span class="keyword">function</span>(parameters, options) {
      $<span class="keyword">this</span> = <span class="keyword">this</span>;
      <span class="keyword">var</span> url = ($.isFunction(<span class="keyword">this</span>.url) ? <span class="keyword">this</span>.url() : <span class="keyword">this</span>.url);
      $.ajax(url, {
        type: <span class="string">"GET"</span>,
        success: <span class="keyword">function</span>(data, textStatus, xhr) {</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Serialize the attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          $<span class="keyword">this</span>.serialize(data);</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Call the success callback if it was specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="keyword">if</span>(options.success) {
            options.success.call($<span class="keyword">this</span>, data, textStatus, xhr);
          }
        }
      });
    },

    save: <span class="keyword">function</span>(parameters, options) {
      <span class="keyword">if</span>(!options) options = {};

      <span class="keyword">if</span>(<span class="keyword">this</span>.isNew) {
        Frame.dataStore.add(<span class="keyword">this</span>, options);
      } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>TODO</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      }
    },

    serialize: <span class="keyword">function</span>(serializableAttributes) {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Get the current object&#39;s constructor so we can bind values to it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> objectClass = <span class="keyword">this</span>.constructor;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Iterate over the retrieved attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> serializableAttributes) {</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Model attributes are &#39;lazily&#39; added.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        objectClass.property(key);</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Assign the attributes value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">this</span>.valueForKey(serializableAttributes[key], key);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Copies the attributes of the model to a new object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    toJSON: <span class="keyword">function</span>() {
      <span class="keyword">var</span> attributes = {};

      <span class="keyword">for</span>(<span class="keyword">var</span> k <span class="keyword">in</span> <span class="keyword">this</span>.properties()) {
        <span class="keyword">if</span>(<span class="keyword">this</span>.properties().hasOwnProperty(k)) {
          attributes[k] = <span class="keyword">this</span>.valueForKey(k);
        }
      }

      <span class="keyword">return</span> attributes;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Validates the model (not the model&#39;s fields), such as URL.
TODO move this to the datastore instead</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    __validateModel: <span class="keyword">function</span>(){
      <span class="keyword">if</span>(!<span class="keyword">this</span>.url) <span class="keyword">throw</span> <span class="string">"No URL specified for model"</span>;
    },
  });

  <span class="comment">/*
   * Views
   */</span>

  <span class="comment">/*
   * Basic view
   */</span>
  <span class="function"><span class="keyword">function</span> <span class="title">splitEventSelector</span><span class="params">(selectorEvent)</span> {</span>
    <span class="keyword">var</span> s = {};
    <span class="keyword">if</span>(selectorEvent.indexOf(<span class="string">' '</span>) != -<span class="number">1</span>) {
      s.event = selectorEvent.substr(<span class="number">0</span>, selectorEvent.indexOf(<span class="string">' '</span>)),
      s.selector = selectorEvent.substr(selectorEvent.indexOf(<span class="string">' '</span>)+<span class="number">1</span>)
    } <span class="keyword">else</span> {
      s.event = selectorEvent;
    }

    <span class="keyword">return</span> s;
  }

  <span class="keyword">var</span> View = BasicObject.extend({
    subviews: [],
    element: <span class="string">'div'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Basic view contstructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    constructor: <span class="keyword">function</span>(options) {
      <span class="keyword">if</span>(!options) options = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Call the basic object&#39;s constructor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      BasicObject.call(<span class="keyword">this</span>, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Set the element of the controller</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.el = options.el;</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Loop through the events if specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span>(<span class="keyword">this</span>.events) {
        <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> <span class="keyword">this</span>.events) {
          <span class="keyword">if</span>(<span class="keyword">this</span>.events.hasOwnProperty(key)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Bind the event to the view (including any sub-queries)
this.events[key] returns a function &#39;pointer&#39; (key)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">this</span>.on(key, <span class="keyword">this</span>[<span class="keyword">this</span>.events[key]]);
          }
        }
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Add a subview to the current view. Takes care of drawing the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addSubview: <span class="keyword">function</span>(subview, options) {</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Add the subview to this view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.subviews.push(subview);</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Set this as the super view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      subview.superView = <span class="keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Draw the view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      subview.draw();</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>If the subview&#39;s el is present it latched on to something.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span>(!subview.el) {
        <span class="keyword">this</span>.$.append(subview.$);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Remove given view from this view. Takes care of unbinding</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeSubview: <span class="keyword">function</span>(subview) {</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Get the index of the current view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> idx = <span class="keyword">this</span>.subviews.indexOf(subview);
      <span class="keyword">if</span>(idx !== -<span class="number">1</span>) {
        <span class="keyword">var</span> subview = <span class="keyword">this</span>.subviews[idx];
        <span class="keyword">delete</span> <span class="keyword">this</span>.subviews[idx];

        subview.wasRemovedFromSuperView();
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Easy function to remove a view of a super view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeFromSuperview: <span class="keyword">function</span>() {
      <span class="keyword">if</span>(<span class="keyword">this</span>.superView) {
        <span class="keyword">this</span>.superView.removeSubview(<span class="keyword">this</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>On DOM event. Uses basic jQuery event handling.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    on: <span class="keyword">function</span>(event, cb) {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Try and split events such as &#39;click #selector&#39; and perform any find queries necessary.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> eventSelector = splitEventSelector(event);
      <span class="keyword">var</span> callback = _.bind(cb, <span class="keyword">this</span>);
      <span class="keyword">if</span>(eventSelector.selector) {
        <span class="keyword">this</span>.$.on(eventSelector.event, eventSelector.selector, callback);

      } <span class="keyword">else</span> {
        <span class="keyword">this</span>.$.on(eventSelector.event, callback);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Remove DOM event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    off: <span class="keyword">function</span>(event, cb) {</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Try and split events such as &#39;click #selector&#39; and perform any find queries necessary.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> eventSelector = splitEventSelector(event);
      <span class="keyword">var</span> callback = _.bind(cb, <span class="keyword">this</span>);
      <span class="keyword">if</span>(eventSelector.selector) {
        <span class="keyword">this</span>.$.find(eventSelector.selector).off(eventSelector.event, callback);
      } <span class="keyword">else</span> {
        <span class="keyword">this</span>.$.off(eventSelector.event, callback);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Function will be called when the view has been removed from the super view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    wasRemovedFromSuperView: <span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Remove from DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.$.remove();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Basic draw method. Should be overwritten for custom drawing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    draw: <span class="keyword">function</span>() {},
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Generic accessor for the view&#39;s element (either created or &#39;fetched&#39;).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Object.defineProperty(View.prototype, <span class="string">"$"</span>, {
    get: <span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Get the bound element or create a new element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> element = <span class="keyword">this</span>.el || <span class="string">'&lt;'</span>+<span class="keyword">this</span>.element+<span class="string">'/&gt;'</span>;

      <span class="keyword">if</span>(!<span class="keyword">this</span>.__collection) <span class="keyword">this</span>.__collection = $(element);

      <span class="keyword">return</span> <span class="keyword">this</span>.__collection;
    }
  });

  <span class="comment">/*
   * Canvas view.
   */</span>
  <span class="keyword">var</span> CanvasView = View.extend({</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Create a canvas element if no element is given</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    element: <span class="string">'canvas'</span>,

    constructor: <span class="keyword">function</span>(options) {
      <span class="keyword">if</span>(!options) options = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Call the super view&#39;s constructor</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      View.call(<span class="keyword">this</span>, options);

      <span class="keyword">this</span>.$.attr({width: options.width, height: options.height});
      <span class="keyword">this</span>.context = <span class="keyword">this</span>.$[<span class="number">0</span>].getContext(<span class="string">'2d'</span>);
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Generic button view</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Button = View.extend({
    element: <span class="string">'button'</span>,

    constructor: <span class="keyword">function</span>(options) {
      <span class="keyword">if</span>(!options) options = {};

      View.call(<span class="keyword">this</span>, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Initialize default text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span>(<span class="string">'text'</span> <span class="keyword">in</span> options) <span class="keyword">this</span>.text(options.text);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Convenient method to set the button&#39;s text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    text: <span class="keyword">function</span>(text) {
      <span class="keyword">this</span>.text = text;

      <span class="keyword">this</span>.draw();
    },

    draw: <span class="keyword">function</span>() {
      <span class="keyword">this</span>.$.text(<span class="keyword">this</span>.text);
    },
  });

  <span class="comment">/*
   * Controllers
   */</span>

  <span class="keyword">var</span> ViewController = BasicObject.extend(
    [</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>The root view of this controller.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="string">'view'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Child view controllers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="string">'viewControllers'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Parent view controller or undefined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="string">'parentViewController'</span>], {
    constructor: <span class="keyword">function</span>(options) {
      <span class="keyword">if</span>(!options) options = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Call the basic object&#39;s constructor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      BasicObject.call(<span class="keyword">this</span>, options);

      <span class="keyword">this</span>.el = options.el;
      <span class="keyword">this</span>.viewControllers = [];
      <span class="keyword">this</span>.parentViewController
    },

    loadView: <span class="keyword">function</span>() {</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Notify the inherited controller that the view is about to be loaded.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.viewWillLoad();</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Create a new View and pass it the el (el may be undefined)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.view = <span class="keyword">new</span> View({el: <span class="keyword">this</span>.el});</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Notify the inherited controller that the view has been loaded and is ready.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.viewDidLoad();</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Return the view so that who ever called this function can add the DOM Nodes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">return</span> <span class="keyword">this</span>.view;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Add a child view controller. This method will take care of calling
the appropriate methods to load the child controllers view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addChildViewController: <span class="keyword">function</span>(controller) {
      <span class="keyword">if</span>(controller.parentViewController) {
        controller.removeFromParentViewController();
      }

      <span class="keyword">this</span>.viewControllers.push(controller);</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Set this as the parent view controller</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      controller.parentViewController = <span class="keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Load the view of the child view controller</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      controller.loadView();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Remove a child view controller from the stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    removeChildViewController: <span class="keyword">function</span>(controller) {
      <span class="keyword">var</span> idx = <span class="keyword">this</span>.viewControllers.indexOf(controller);
      <span class="keyword">if</span>(idx != -<span class="number">1</span>) {
        <span class="keyword">delete</span> <span class="keyword">this</span>.viewControllers[idx];
        controller.parentViewController = <span class="literal">undefined</span>;
      }
    },

    removeFromParentViewController: <span class="keyword">function</span>() {
      <span class="keyword">if</span>(<span class="keyword">this</span>.parentViewController) {
        <span class="keyword">this</span>.parentViewController.removeChildViewController(<span class="keyword">this</span>);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Will be called when the view is done loading and is set up.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    viewDidLoad:  <span class="keyword">function</span>(){},</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Will be called before any view loading is done.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    viewWillLoad: <span class="keyword">function</span>(){},
  });


  <span class="comment">/*
   * Basic DataStore. All New datastores inherit from this object
   */</span>
  <span class="keyword">var</span> DataStore = BasicObject.extend({
    open: <span class="keyword">function</span>(name, callback, options) {},
    add: <span class="keyword">function</span>(object, options) {},
    addByStoreName: <span class="keyword">function</span>(storeName, data, options) {},
    deleteByStoreName: <span class="keyword">function</span>(storeName, id, options) {},
    getAllByStoreName: <span class="keyword">function</span>(storeName, options) {},
  });

  <span class="comment">/*
   * Application class, root of the application stack.
   */</span>
  <span class="keyword">var</span> Application = BasicObject.extend({
    didFinishLoading: <span class="keyword">function</span>() {
      <span class="keyword">throw</span> Error(<span class="string">"didFinishLoading was not everwritten by subclass or Frame.Application was used directly as application class."</span>);
    },
    willTerminate: <span class="keyword">function</span>(){}
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Frame.BasicObject = BasicObject;
  Frame.Model = Model;</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Views</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Frame.View = View;
  Frame.CanvasView = CanvasView;
  Frame.Button = Button;</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Controllers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Frame.ViewController = ViewController;

  Frame.DataStore = DataStore;
  Frame.dataStore = <span class="literal">undefined</span>;

  Frame.Application = Application;</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Frame.createDefaultInstanceMethodOn = createDefaultInstanceMethodOn;
  Frame.has = __has;
  Frame.keys = __keys;
  Frame.makeArray = __makeArray;
  Frame.isBasicObject = __isBasicObject;
  Frame.gid = __gid;

  <span class="comment">/*
   * Define the application accessor.
   * Once the application property is set it will use it to create
   * a new instance of that object and uses that as the root of your application.
   */</span>
  Object.defineProperty(Frame, <span class="string">'application'</span>, {
    set: <span class="keyword">function</span>(ApplicationObject) {
      <span class="keyword">var</span> app;</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Create a new application instance from the given application class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      app = <span class="keyword">new</span> ApplicationObject();</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>Set Frame&#39;s application instance.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.applicationInstance = app;

      app.didFinishLaunching();</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>If a rootViewController is set call the conrollers loadView method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span>(app.rootViewController) {</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>Set the body if no element has been set on the root controller.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span>(!app.rootViewController.el) app.rootViewController.el = <span class="string">'body'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>Load the view and draw it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">var</span> view = app.rootViewController.loadView();
        view.draw();
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>Set up the terminate callback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      $(window).on(<span class="string">'beforeunload'</span>, <span class="keyword">function</span>() {
        app.willTerminate();
      });
    },
  });

  window.Frame = Frame;
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
