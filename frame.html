<!DOCTYPE html>

<html>
<head>
  <title>frame.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>frame.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>$(<span class="keyword">function</span>() {
  <span class="keyword">var</span> Frame = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Helper methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> __emptyHash = {}, __has, __extend, __currentGID = <span class="number">0</span>,
  __has = <span class="keyword">function</span>(object, property) { <span class="keyword">return</span> __emptyHash.hasOwnProperty.call(object, property); },
  __keys = <span class="keyword">function</span>(object) {
    <span class="keyword">var</span> keys = []
    <span class="keyword">for</span>(<span class="keyword">var</span> k <span class="keyword">in</span> object) {
      <span class="keyword">if</span>(object.hasOwnProperty(k)) {
        keys.push(k);
      }
    }
    <span class="keyword">return</span> keys;
  },
  __makeArray = <span class="keyword">function</span>(object) {
    <span class="keyword">if</span>( !(object <span class="keyword">instanceof</span> Array) ) {
      object = [object];
    }
    <span class="keyword">return</span> object;
  },
  __isBasicObject = <span class="keyword">function</span>(object) {
    <span class="keyword">return</span> __has(object, <span class="string">'basicObjectDefined'</span>);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Returns a new GID with the given prefix. GIDs are always returned as string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  __gid = <span class="keyword">function</span>(prefix) {
    <span class="keyword">var</span> GID = (++__currentGID).toString();
    <span class="keyword">if</span>(prefix) {
      GID = prefex+<span class="string">"-"</span>+GID;
    }

    <span class="keyword">return</span> GID;
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Creates a shared instance method</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="function"><span class="keyword">function</span> <span class="title">createDefaultInstanceMethodOn</span><span class="params">(object)</span> {</span>
    Object.defineProperty(object, <span class="string">'default'</span>, {
      get: <span class="keyword">function</span>() {
        <span class="keyword">if</span>(!<span class="keyword">this</span>.__sharedInstance) { <span class="keyword">this</span>.__sharedInstance = <span class="keyword">new</span> object(); }
        <span class="keyword">return</span> <span class="keyword">this</span>.__sharedInstance;
      },
      set: <span class="keyword">function</span>(){}
    });
  }

  __extend = <span class="keyword">function</span>(propertiesOrProtoProps, protoProps) {
    <span class="keyword">var</span> parent = <span class="keyword">this</span>;
    <span class="keyword">var</span> child, properties;
    <span class="keyword">if</span>(propertiesOrProtoProps <span class="keyword">instanceof</span> Array) {
      properties = properties;
    } <span class="keyword">else</span> {
      protoProps = propertiesOrProtoProps;
    }

    <span class="keyword">if</span> (protoProps &amp;&amp; __has(protoProps, <span class="string">'constructor'</span>)) {
      child = protoProps.constructor;
    } <span class="keyword">else</span> {
      child = <span class="keyword">function</span>(){ <span class="keyword">return</span> parent.apply(<span class="keyword">this</span>, arguments); };
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Set the prototype chain to inherit from <code>parent</code>, without calling
<code>parent</code>&#39;s constructor function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> Surrogate = <span class="keyword">function</span>(){ <span class="keyword">this</span>.constructor = child; };
    Surrogate.prototype = parent.prototype;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Copy over static methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> protoProps) {
      <span class="keyword">if</span> (__has(protoProps, key)) {
        Surrogate.prototype[key] = protoProps[key];
      }
    }
    child.prototype = <span class="keyword">new</span> Surrogate;</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Copy over static methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> parent) {
      <span class="keyword">if</span> (__has(parent, key)) {
        child[key] = parent[key];
      }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Set a convenience property in case the parent&#39;s prototype is needed
later.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    child.__super__ = parent.prototype;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Set the properties on the object if any was given</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span>(properties) {
      child.property(properties);
    }

    <span class="keyword">return</span> child;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Basic low level object. Contains most low level object functions such as KVO &amp; KVC.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> BasicObject = <span class="keyword">function</span>(options) {
    <span class="comment">/* These values are not meant to be KVO. */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Determines whether this object is a basic object so you can distinguish them from regular objects.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>.basicObjectDefined=<span class="literal">true</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>The current id of the object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>.gid = __gid();

    <span class="keyword">if</span>(<span class="keyword">this</span>.initialize) {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Call the initialize method if it&#39;s present and pass in the options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.initialize.apply(<span class="keyword">this</span>, options);
    }
  };
  BasicObject.extend = __extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Public property setter. Creates specialized properties which can be accessed through KVC and make use of KVO</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.property = <span class="keyword">function</span>(propertyNames) {
    propertyNames = __makeArray(propertyNames);

    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; propertyNames.length; i++) {
      <span class="keyword">var</span> propertyName = propertyNames[i];

      <span class="keyword">if</span>( !(propertyNames <span class="keyword">in</span> <span class="keyword">this</span>.prototype) ) {
        Object.defineProperty(<span class="keyword">this</span>.prototype, propertyName, {
          enumerable: <span class="literal">true</span>,
          get: <span class="keyword">function</span>() {
            <span class="keyword">return</span> <span class="keyword">this</span>.getProperty(propertyName)
          },
          set: <span class="keyword">function</span>(value) {
            <span class="keyword">this</span>.setProperty(propertyName, value)
          }
        });
      }
    }
  }

  BasicObject.prototype.properties = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>._properties || (<span class="keyword">this</span>._properties = {})
  }
  BasicObject.prototype.observers = <span class="keyword">function</span>() {
    <span class="keyword">return</span> <span class="keyword">this</span>._observers || (<span class="keyword">this</span>._observers = {})
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Specialized setter. Calls callbacks on observed values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.setProperty = <span class="keyword">function</span>(key, value) {
    <span class="keyword">this</span>.properties()[key] = value

    <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key] &amp;&amp; <span class="keyword">this</span>.observers[key].length &gt; <span class="number">0</span>) {
      <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.observers[key].length; i++) {
        <span class="keyword">var</span> observer = <span class="keyword">this</span>.observers[key][i]
        <span class="keyword">if</span>(observer !== <span class="literal">undefined</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Signal the observer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          observer.observeValueForKey.call(observer, key, value)
        }
      }
    }
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Basic object getter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.getProperty = <span class="keyword">function</span>(key) {
    <span class="keyword">return</span> <span class="keyword">this</span>.properties()[key]
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Returns the given or sets the given key with value (Key Value Coding, KVC)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.valueForKey = <span class="keyword">function</span>(value_or_key, key) {
    <span class="keyword">if</span>(key === <span class="literal">undefined</span>) {
      <span class="keyword">return</span> <span class="keyword">this</span>.getProperty(value_or_key)
    }

    <span class="keyword">this</span>.setProperty(key, value_or_key)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Observe the given key. (Key Value Observing, KVO)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.addObserverForKey = <span class="keyword">function</span>(observer, key, options) {
    <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key] === <span class="literal">undefined</span>) {
      <span class="keyword">this</span>.observers[key] = []
    }

    <span class="keyword">this</span>.observers[key].push(observer)
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Remove the given observer with the specified key</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  BasicObject.prototype.removeObserverForKey = <span class="keyword">function</span>(observer, key) {
    <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key]) {
      <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.observers[key].length; i++) {
        <span class="keyword">if</span>(<span class="keyword">this</span>.observers[key][i] === observer) {
          <span class="keyword">delete</span> <span class="keyword">this</span>.observers[key][i]
          <span class="keyword">break</span>
        }
      }
    }
  }

  <span class="comment">/*
   * Frame.Model data object.
   */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>The basic model. Inherit from this object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Model = BasicObject.extend({
    constructor: <span class="keyword">function</span>(attributes, options) {</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Call the basic object&#39;s constructor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      BasicObject.call(<span class="keyword">this</span>, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Serialize the attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.serialize(attributes);

      <span class="keyword">if</span>(<span class="keyword">this</span>.initialize) {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Call the initialize method if it&#39;s present and pass in the options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">this</span>.initialize.apply(<span class="keyword">this</span>, options);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Load data from the remote source</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    fetch: <span class="keyword">function</span>(parameters, options) {
      <span class="keyword">this</span>.__validateModel();

      $<span class="keyword">this</span> = <span class="keyword">this</span>;
      <span class="keyword">var</span> url = ($.isFunction(<span class="keyword">this</span>.url) ? <span class="keyword">this</span>.url() : <span class="keyword">this</span>.url);
      $.ajax(url, {
        type: <span class="string">"GET"</span>,
        success: <span class="keyword">function</span>(data, textStatus, xhr) {</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Serialize the attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          $<span class="keyword">this</span>.serialize(data);</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Call the success callback if it was specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="keyword">if</span>(options.success) {
            options.success.call($<span class="keyword">this</span>, data, textStatus, xhr);
          }
        }
      });
    },

    save: <span class="keyword">function</span>(parameters, options) {
      <span class="keyword">this</span>.__validateModel();
    },

    serialize: <span class="keyword">function</span>(serializableAttributes) {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Get the current object&#39;s constructor so we can bind values to it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">var</span> objectClass = <span class="keyword">this</span>.constructor;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Iterate over the retrieved attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> serializableAttributes) {</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Model attributes are &#39;lazily&#39; added.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        objectClass.property(key);</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Assign the attributes value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">this</span>.valueForKey(serializableAttributes[key], key);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Copies the attributes of the model to a new object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    toJSON: <span class="keyword">function</span>() {
      <span class="keyword">var</span> attributes = {};

      <span class="keyword">for</span>(<span class="keyword">var</span> k <span class="keyword">in</span> <span class="keyword">this</span>.properties()) {
        <span class="keyword">if</span>(<span class="keyword">this</span>.properties().hasOwnProperty(k)) {
          attributes[k] = <span class="keyword">this</span>.valueForKey(k);
        }
      }

      <span class="keyword">return</span> attributes;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Validates the model (not the model&#39;s fields), such as URL.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    __validateModel: <span class="keyword">function</span>(){
      <span class="keyword">if</span>(!<span class="keyword">this</span>.url) <span class="keyword">throw</span> <span class="string">"No URL specified for model"</span>;
    },
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Objects</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Frame.BasicObject = BasicObject;
  Frame.Model = Model;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Methods</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Frame.createDefaultInstanceMethodOn = createDefaultInstanceMethodOn;
  Frame.has = __has;
  Frame.keys = __keys;
  Frame.makeArray = __makeArray;
  Frame.isBasicObject = __isBasicObject;
  Frame.gid = __gid;

  window.Frame = Frame;
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
